#+STARTUP: indent

#+LATEX_HEADER: \usepackage[margin=1.5cm,includefoot]{geometry}
#+LATEX_HEADER: \usepackage[none]{hyphenat}
#+LATEX_HEADER: \usepackage{array}
#+LATEX_HEADER: \newcolumntype{$}{>{\global\let\currentrowstyle\relax}}
#+LATEX_HEADER: \newcolumntype{^}{>{\currentrowstyle}}
#+LATEX_HEADER: \newcommand{\rowstyle}[1]{\gdef\currentrowstyle{#1} #1\ignorespaces}

#+OPTIONS: toc:nil title:nil

\begin{titlepage}
  \begin{center}
    \line(1,0){300} \\
    [5mm]
    \huge{\bfseries Numerical Methods Coursework} \\
    [5mm]
    \huge{Gleb Dianov} \\
  \end{center}
\end{titlepage}

\newpage

\tableofcontents

\newpage

* Problem specification
$$ f(x) = \frac{sin(x)}{ln(x)} + 1 $$

$$ \int_{4}^{8} f(x) dx = \int_{4}^{8} (\frac{sin(x)}{ln(x)} + 1) dx $$

This integral cannot be solved analytically.

#+CAPTION: Graph of $f(x)$.
[[./function_graph.png]]

* Strategy
On interval $[4,8]$ it is continuous and positive, so we can use the Simpson's rule to estimate the integral. It can be derived from the midpoint and the trapezium rules. Estimating definite integrals is estimating areas. Trapezium rule estimates the area by splitting it into trapezoids and calculating their areas. The midpoint rule does almost the same thing, but instead of calculating the average of lengths of bases to find the area it uses the integrand value at the middle point of a range.

$$ M_n = h * \sum_{i=1}^{n-1} f (a + (i + 0.5) h) $$

$$ T_n = \frac{h}{2} * (f(a) + 2 \sum_{i=1}^{n-1} f(a + i*h) + f(b)) $$

If we take the weighted average of these then the leading error term vanishes.

$$ S_n = \frac{2M_n+T_n}{3} $$

* Formula application
#+ATTR_LATEX: :mode math :environment bmatrix
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
|  n |               T_n |               M_n |               S_n |      S_n - S_{n/2} | \frac{S_n - S_{n/2}}{S_{n/2} - S_{n/4}} |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
|  2 | 3.617973624362951 | 3.483622345190564 | 3.528406104914693 |                    |                                         |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
|  4 | 3.550797984776757 | 3.516669866703652 | 3.528045906061354 | -0.000360198853339 |                                         |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
|  8 | 3.533733925740205 | 3.525167844161146 | 3.528023204687499 | -0.000022701373855 |                       0.063024558920655 |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
| 16 | 3.529450884950675 | 3.527307202384797 | 3.528021763240090 | -0.000001441447409 |                       0.063496042914706 |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
| 32 | 3.528379043667736 | 3.527842987194325 | 3.528021672685462 | -0.000000090554628 |                       0.062822013278819 |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|
| 64 | 3.528111015431030 | 3.527976992811555 | 3.528021667018047 | -0.000000005667415 |                       0.062585591613435 |
|----+-------------------+-------------------+-------------------+--------------------+-----------------------------------------|

* Error analysis

$$ \frac{S_{4n} - S_{2n}}{S_{2n} - S_n} \approx \frac{1}{16} $$
$$ S_{4n} \approx S_{2n} + \frac{S_{2n} - S_n}{16} $$
$$ \implies S_{8n} \approx S_{4n} + \frac{S_{4n} - S_{2n}}{16} \approx S_{2n} + \frac{S_{2n} - S_n}{16} + \frac{S_{2n} + \frac{S_{2n} - S_n}{16} - S_{2n}}{16} \approx S_{2n} + \frac{S_{2n} - S_n}{16} + \frac{S_{2n} - S_n}{16^2} $$
$$ S_{16n} \approx S_{2n} + \frac{S_{2n} - S_n}{16} + \frac{S_{2n} - S_n}{16^2} + \frac{S_{2n} - S_n}{16^3} $$
$$ S_{\infty} \approx S_{2n} + (S_{2n} - S_n) \sum_{k=1}^{\infty} 16^{-k} = S_{2n} + (S_{2n} - S_n) \frac{\frac{1}{16}}{1-\frac{1}{16}} = S_{2n} + \frac{S_{2n} - S_n}{15}$$

#+ATTR_LATEX: :mode math :environment bmatrix
|----+-------------------+-------------------|
|  n |               S_n |        S_{\infty} |
|----+-------------------+-------------------|
|  2 | 3.617973624362951 |                   |
|----+-------------------+-------------------|
|  4 | 3.550797984776757 | 3.528021892804465 |
|----+-------------------+-------------------|
|  8 | 3.533733925740205 | 3.528021691262575 |
|----+-------------------+-------------------|
| 16 | 3.529450884950675 | 3.528021667143596 |
|----+-------------------+-------------------|
| 32 | 3.528379043667736 | 3.528021666648486 |
|----+-------------------+-------------------|
| 64 | 3.528111015431030 | 3.528021666640219 |
|----+-------------------+-------------------|

* Interpretation

$$ \int_{4}^{8} (\frac{sin(x)}{ln(x)} + 1) dx \approx 3.528022 $$

We can see that Simpson's rule estimates round to $3.528022$ for $n = 16, 32, 64$. Also the extrapolations to infinity for these values of $n$ round to it. Therefore, we can say with a high level of confidence that it is the integral to 6 decimal places.

\newpage
* Use of technology

#+BEGIN_SRC haskell
#+END_SRC

Function ~trp~ takes a function that we want to integrate, ~n~, and an interval. It returns an estimate of the integral calculated using the trapezium rule:

$$ T_n = \frac{h}{2} * (f(a) + 2 \sum_{i=1}^{n-1} f(a + i*h) + f(b)) $$

Function ~mid~ takes a function that we want to integrate, ~n~, and an interval. It returns an estimate of the integral calculated using the midpoint rule:

$$ M_n = h * \sum_{i=1}^{n-1} f (a + (i + 0.5) h) $$

Function ~simp~ takes a function that we want to integrate, ~n~, and an interval. It returns an estimate of the integral calculated using the Simpson's rule:

$$ S_n = \frac{2 M_n + T_n}{3} $$

Function ~diffs~ takes a list of pairs and returns a list of tupples with differences and ratios of differences.

Function ~extrapolate~ calculates extrapolations to infinity of the Simpson's method.

Function ~showD~ takes a double and prints it to 15 decimal points.

The main function calculates $S_2$, $S_4$, $S_8$, $S_16$, $S_32$, $S_64$; finds the differences and the ratios of the differences; approximates $S_{\infty}$; calculates values of $T_n$ and $M_n$; and writes all the results into a csv file called "results.csv".

